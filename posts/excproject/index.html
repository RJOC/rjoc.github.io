<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        EXCProject ::
        Ryan O&#39;Connor â€” Ryan&#39;s Website
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="package imdb import scala.io.Source case class TitleBasics(tconst: String, titleType: Option[String], primaryTitle: Option[String], originalTitle: Option[String], isAdult: Int, startYear: Option[Int], endYear: Option[Int], runtimeMinutes: Option[Int], genres: Option[List[String]]) case class TitleRatings(tconst: String, averageRating: Float, numVotes: Int) case class TitleCrew(tconst: String, directors: Option[List[String]], writers: Option[List[String]]) case class NameBasics(nconst: String, primaryName: Option[String], birthYear: Option[Int], deathYear: Option[Int], primaryProfession: Option[List[String]], knownForTitles: Option[List[String]]) object ImdbAnalysis { // Hint: use a combination of `ImdbData.titleBasicsPath` and `ImdbData.parseTitleBasics`  val titleBasicsList: List[TitleBasics] = Source."
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://rjoc.github.io/posts/excproject/" />





<link rel="stylesheet" href="https://rjoc.github.io/assets/style.css" />

<link rel="stylesheet" href="https://rjoc.github.io/style.css" />


<link
  rel="apple-touch-icon-precomposed"
  sizes="144x144"
  href="https://rjoc.github.io/img/apple-touch-icon-144-precomposed.png"
/>
<link rel="shortcut icon" href="https://rjoc.github.io/img/favicon.png" />


<link href="https://rjoc.github.io/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://rjoc.github.io/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://rjoc.github.io/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://rjoc.github.io/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://rjoc.github.io/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://rjoc.github.io/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="EXCProject"/>
<meta name="twitter:description" content="package imdb import scala.io.Source case class TitleBasics(tconst: String, titleType: Option[String], primaryTitle: Option[String], originalTitle: Option[String], isAdult: Int, startYear: Option[Int], endYear: Option[Int], runtimeMinutes: Option[Int], genres: Option[List[String]]) case class TitleRatings(tconst: String, averageRating: Float, numVotes: Int) case class TitleCrew(tconst: String, directors: Option[List[String]], writers: Option[List[String]]) case class NameBasics(nconst: String, primaryName: Option[String], birthYear: Option[Int], deathYear: Option[Int], primaryProfession: Option[List[String]], knownForTitles: Option[List[String]]) object ImdbAnalysis { // Hint: use a combination of `ImdbData.titleBasicsPath` and `ImdbData.parseTitleBasics`  val titleBasicsList: List[TitleBasics] = Source."/>



<meta property="og:title" content="EXCProject" />
<meta property="og:description" content="package imdb import scala.io.Source case class TitleBasics(tconst: String, titleType: Option[String], primaryTitle: Option[String], originalTitle: Option[String], isAdult: Int, startYear: Option[Int], endYear: Option[Int], runtimeMinutes: Option[Int], genres: Option[List[String]]) case class TitleRatings(tconst: String, averageRating: Float, numVotes: Int) case class TitleCrew(tconst: String, directors: Option[List[String]], writers: Option[List[String]]) case class NameBasics(nconst: String, primaryName: Option[String], birthYear: Option[Int], deathYear: Option[Int], primaryProfession: Option[List[String]], knownForTitles: Option[List[String]]) object ImdbAnalysis { // Hint: use a combination of `ImdbData.titleBasicsPath` and `ImdbData.parseTitleBasics`  val titleBasicsList: List[TitleBasics] = Source." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rjoc.github.io/posts/excproject/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-14T17:40:26-08:00" />
<meta property="article:modified_time" content="2021-12-14T17:40:26-08:00" /><meta property="og:site_name" content="Ryan O&#39;Connor" />







  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >Ryan O&#39;Connor</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/tags/project">Projects</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/tags/project">Projects</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">EXCProject</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2021-12-14
        </span>

        
          
        
      

      


      
    </div>

    

    

    <div class="post-content">
      
      <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">imdb</span>

<span style="color:#f92672">import</span> <span style="color:#a6e22e">scala</span>.<span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">Source</span>

<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">class</span> <span style="color:#a6e22e">TitleBasics</span>(<span style="color:#a6e22e">tconst</span>: <span style="color:#a6e22e">String</span>, <span style="color:#a6e22e">titleType</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">String</span>], <span style="color:#a6e22e">primaryTitle</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">String</span>],
                      <span style="color:#a6e22e">originalTitle</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">String</span>], <span style="color:#a6e22e">isAdult</span>: <span style="color:#a6e22e">Int</span>, <span style="color:#a6e22e">startYear</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">Int</span>], <span style="color:#a6e22e">endYear</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">Int</span>],
                      <span style="color:#a6e22e">runtimeMinutes</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">Int</span>], <span style="color:#a6e22e">genres</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">String</span>]])
<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">class</span> <span style="color:#a6e22e">TitleRatings</span>(<span style="color:#a6e22e">tconst</span>: <span style="color:#a6e22e">String</span>, <span style="color:#a6e22e">averageRating</span>: <span style="color:#a6e22e">Float</span>, <span style="color:#a6e22e">numVotes</span>: <span style="color:#a6e22e">Int</span>)
<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">class</span> <span style="color:#a6e22e">TitleCrew</span>(<span style="color:#a6e22e">tconst</span>: <span style="color:#a6e22e">String</span>, <span style="color:#a6e22e">directors</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">String</span>]], <span style="color:#a6e22e">writers</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">String</span>]])
<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">class</span> <span style="color:#a6e22e">NameBasics</span>(<span style="color:#a6e22e">nconst</span>: <span style="color:#a6e22e">String</span>, <span style="color:#a6e22e">primaryName</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">String</span>], <span style="color:#a6e22e">birthYear</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">Int</span>], <span style="color:#a6e22e">deathYear</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">Int</span>],
                      <span style="color:#a6e22e">primaryProfession</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">String</span>]], <span style="color:#a6e22e">knownForTitles</span>: <span style="color:#a6e22e">Option</span>[<span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">String</span>]])

<span style="color:#a6e22e">object</span> <span style="color:#a6e22e">ImdbAnalysis</span> {

  <span style="color:#75715e">// Hint: use a combination of `ImdbData.titleBasicsPath` and `ImdbData.parseTitleBasics`
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">titleBasicsList</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">TitleBasics</span>] = <span style="color:#a6e22e">Source</span>.<span style="color:#a6e22e">fromFile</span>(<span style="color:#a6e22e">ImdbData</span>.<span style="color:#a6e22e">titleBasicsPath</span>).<span style="color:#a6e22e">getLines</span>.<span style="color:#a6e22e">toList</span>.<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">x</span> =&gt; <span style="color:#a6e22e">ImdbData</span>.<span style="color:#a6e22e">parseTitleBasics</span>(<span style="color:#a6e22e">x</span>.<span style="color:#a6e22e">mkString</span>))
  
  <span style="color:#75715e">// Hint: use a combination of `ImdbData.titleRatingsPath` and `ImdbData.parseTitleRatings`
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">titleRatingsList</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">TitleRatings</span>] = <span style="color:#a6e22e">Source</span>.<span style="color:#a6e22e">fromFile</span>(<span style="color:#a6e22e">ImdbData</span>.<span style="color:#a6e22e">titleRatingsPath</span>).<span style="color:#a6e22e">getLines</span>.<span style="color:#a6e22e">toList</span>.<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">y</span> =&gt; <span style="color:#a6e22e">ImdbData</span>.<span style="color:#a6e22e">parseTitleRatings</span>(<span style="color:#a6e22e">y</span>.<span style="color:#a6e22e">mkString</span>))

  <span style="color:#75715e">// Hint: use a combination of `ImdbData.titleCrewPath` and `ImdbData.parseTitleCrew`
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">titleCrewList</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">TitleCrew</span>] = <span style="color:#a6e22e">Source</span>.<span style="color:#a6e22e">fromFile</span>(<span style="color:#a6e22e">ImdbData</span>.<span style="color:#a6e22e">titleCrewPath</span>).<span style="color:#a6e22e">getLines</span>.<span style="color:#a6e22e">toList</span>.<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">z</span> =&gt; <span style="color:#a6e22e">ImdbData</span>.<span style="color:#a6e22e">parseTitleCrew</span>(<span style="color:#a6e22e">z</span>))

  <span style="color:#75715e">// Hint: use a combination of `ImdbData.nameBasicsPath` and `ImdbData.parseNameBasics`
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">nameBasicsList</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">NameBasics</span>] = <span style="color:#a6e22e">Source</span>.<span style="color:#a6e22e">fromFile</span>(<span style="color:#a6e22e">ImdbData</span>.<span style="color:#a6e22e">nameBasicsPath</span>).<span style="color:#a6e22e">getLines</span>.<span style="color:#a6e22e">toList</span>.<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">q</span> =&gt; <span style="color:#a6e22e">ImdbData</span>.<span style="color:#a6e22e">parseNameBasics</span>(<span style="color:#a6e22e">q</span>))


  <span style="color:#a6e22e">def</span> <span style="color:#a6e22e">task1</span>(<span style="color:#a6e22e">list</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">TitleBasics</span>]): <span style="color:#a6e22e">List</span>[(<span style="color:#a6e22e">Float</span>, <span style="color:#a6e22e">Int</span>, <span style="color:#a6e22e">Int</span>, <span style="color:#a6e22e">String</span>)] = {
    <span style="color:#75715e">//Getting list of all the genres
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">allGenres</span> = (<span style="color:#a6e22e">list</span>.<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">x</span> =&gt; <span style="color:#a6e22e">x</span>.<span style="color:#a6e22e">genres</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#a6e22e">Nil</span>))).<span style="color:#a6e22e">flatten</span>.<span style="color:#a6e22e">distinct</span>
    <span style="color:#75715e">//Carrying out the tasks and sorting per the question asked, returning a list of (AvgRT, MinRT, MaxRT, Genre)
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">T1_Result</span> = <span style="color:#a6e22e">allGenres</span>.<span style="color:#a6e22e">foldLeft</span>(<span style="color:#a6e22e">List</span>[(<span style="color:#a6e22e">Float</span>, <span style="color:#a6e22e">Int</span>, <span style="color:#a6e22e">Int</span>, <span style="color:#a6e22e">String</span>)]())((<span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">genre</span>) =&gt; {
      <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">containingGenre</span> = <span style="color:#a6e22e">list</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">_</span>.<span style="color:#a6e22e">genres</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#a6e22e">List</span>.<span style="color:#a6e22e">empty</span>).<span style="color:#a6e22e">contains</span>(<span style="color:#a6e22e">genre</span>))
      <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">max_min_filter</span> = <span style="color:#a6e22e">containingGenre</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">_</span>.<span style="color:#a6e22e">runtimeMinutes</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>)
      <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">avg_Runtime</span> = ((<span style="color:#a6e22e">containingGenre</span>.<span style="color:#a6e22e">foldLeft</span>(<span style="color:#ae81ff">0.0</span>)(<span style="color:#a6e22e">_</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">_</span>.<span style="color:#a6e22e">runtimeMinutes</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#ae81ff">0</span>))) <span style="color:#f92672">/</span> (<span style="color:#a6e22e">containingGenre</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">_</span>.<span style="color:#a6e22e">runtimeMinutes</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> ).<span style="color:#a6e22e">length</span>)).<span style="color:#a6e22e">toFloat</span>
      <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">max_Runtime</span> = <span style="color:#a6e22e">max_min_filter</span>.<span style="color:#a6e22e">maxBy</span>(<span style="color:#a6e22e">_</span>.<span style="color:#a6e22e">runtimeMinutes</span>).<span style="color:#a6e22e">runtimeMinutes</span>.<span style="color:#a6e22e">get</span>
      <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">min_Runtime</span> = <span style="color:#a6e22e">max_min_filter</span>.<span style="color:#a6e22e">minBy</span>(<span style="color:#a6e22e">_</span>.<span style="color:#a6e22e">runtimeMinutes</span>).<span style="color:#a6e22e">runtimeMinutes</span>.<span style="color:#a6e22e">get</span>
      (<span style="color:#a6e22e">avg_Runtime</span>,<span style="color:#a6e22e">min_Runtime</span>,<span style="color:#a6e22e">max_Runtime</span>,<span style="color:#a6e22e">genre</span>) :: <span style="color:#a6e22e">result</span>
    })
  
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">T1_Result</span>
  }

  <span style="color:#a6e22e">def</span> <span style="color:#a6e22e">task2</span>(<span style="color:#a6e22e">l1</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">TitleBasics</span>], <span style="color:#a6e22e">l2</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">TitleRatings</span>]): <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">String</span>] = {
    <span style="color:#75715e">//List of movies
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//average rating of 7.5 or more
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//recieved 500000 votes or more
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">listOfMovieTConsts</span> = <span style="color:#a6e22e">l2</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">tr</span> =&gt; (<span style="color:#a6e22e">tr</span>.<span style="color:#a6e22e">averageRating</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">7.5</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">tr</span>.<span style="color:#a6e22e">numVotes</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">500000</span>))
        <span style="color:#75715e">//containing the word &#39;movie&#39; so that is &#39;tvMovie&#39; and &#39;movie&#39;
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//between startYear 1990 and 2018 inclusive
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">T2_Result</span> = <span style="color:#a6e22e">listOfMovieTConsts</span>.<span style="color:#a6e22e">flatMap</span>(<span style="color:#a6e22e">y</span> =&gt; <span style="color:#a6e22e">l1</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">tb</span> =&gt; (<span style="color:#a6e22e">tb</span>.<span style="color:#a6e22e">tconst</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">y</span>.<span style="color:#a6e22e">tconst</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">tb</span>.<span style="color:#a6e22e">titleType</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#ae81ff">0</span>).<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;movie&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">tb</span>.<span style="color:#a6e22e">startYear</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">1990</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">tb</span>.<span style="color:#a6e22e">startYear</span>.<span style="color:#a6e22e">get</span> <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">2018</span> )).<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">z</span> =&gt; <span style="color:#a6e22e">z</span>.<span style="color:#a6e22e">primaryTitle</span>.<span style="color:#a6e22e">get</span>))
      <span style="color:#75715e">//Return the titles of movies
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">T2_Result</span>
  }

  <span style="color:#a6e22e">def</span> <span style="color:#a6e22e">task3</span>(<span style="color:#a6e22e">l1</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">TitleBasics</span>], <span style="color:#a6e22e">l2</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">TitleRatings</span>]): <span style="color:#a6e22e">List</span>[(<span style="color:#a6e22e">Int</span>, <span style="color:#a6e22e">String</span>, <span style="color:#a6e22e">String</span>)] = {
    <span style="color:#75715e">//Mapping for l1 with titles &#34;Movie&#34; and more than 0 genres, start year is between 1900 and 1999
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">l1Mapping</span> = <span style="color:#a6e22e">l1</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">title</span> =&gt; <span style="color:#a6e22e">title</span>.<span style="color:#a6e22e">titleType</span>.<span style="color:#a6e22e">get</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;movie&#34;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">title</span>.<span style="color:#a6e22e">genres</span>.<span style="color:#a6e22e">size</span> &gt; <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">title</span>.<span style="color:#a6e22e">startYear</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">1900</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">title</span>.<span style="color:#a6e22e">startYear</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1999</span> ).<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">title</span> =&gt; <span style="color:#a6e22e">title</span>.<span style="color:#a6e22e">tconst</span><span style="color:#f92672">-</span>&gt;<span style="color:#a6e22e">title</span>).<span style="color:#a6e22e">toMap</span>
    <span style="color:#75715e">//Mapping tconst to rating
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">l2Mapping</span> = <span style="color:#a6e22e">l2</span>.<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">rating</span> =&gt; <span style="color:#a6e22e">rating</span>.<span style="color:#a6e22e">tconst</span><span style="color:#f92672">-</span>&gt;<span style="color:#a6e22e">rating</span>).<span style="color:#a6e22e">toMap</span>
    <span style="color:#75715e">//Mapping the two above mappings
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">l1l2Mapping</span> = <span style="color:#a6e22e">l1Mapping</span>.<span style="color:#a6e22e">keySet</span>.<span style="color:#a6e22e">intersect</span>(<span style="color:#a6e22e">l2Mapping</span>.<span style="color:#a6e22e">keySet</span>).<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">key</span> =&gt; (<span style="color:#a6e22e">l1Mapping</span>(<span style="color:#a6e22e">key</span>),<span style="color:#a6e22e">l2Mapping</span>(<span style="color:#a6e22e">key</span>))).<span style="color:#a6e22e">toList</span>
    <span style="color:#75715e">//Grouping by year
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">gbYear</span> = <span style="color:#a6e22e">l1l2Mapping</span>.<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">movie</span> =&gt; {
      <span style="color:#a6e22e">movie</span>.<span style="color:#a6e22e">_1</span>.<span style="color:#a6e22e">genres</span>.<span style="color:#a6e22e">get</span>.<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">genre</span> =&gt; (((<span style="color:#a6e22e">movie</span>.<span style="color:#a6e22e">_1</span>.<span style="color:#a6e22e">startYear</span>.<span style="color:#a6e22e">get</span> <span style="color:#f92672">/</span><span style="color:#ae81ff">10</span>)<span style="color:#f92672">%</span><span style="color:#ae81ff">10</span>).<span style="color:#a6e22e">toInt</span>, <span style="color:#a6e22e">genre</span>, <span style="color:#a6e22e">movie</span>))
    }).<span style="color:#a6e22e">flatten</span>.<span style="color:#a6e22e">groupBy</span>(<span style="color:#a6e22e">_</span>.<span style="color:#a6e22e">_1</span>).<span style="color:#a6e22e">toList</span>

    <span style="color:#75715e">//Carrying out check related to max for each genre and decade
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">T3_Result</span> = <span style="color:#a6e22e">gbYear</span>.<span style="color:#a6e22e">foldLeft</span>(<span style="color:#a6e22e">List</span>[(<span style="color:#a6e22e">Int</span>,<span style="color:#a6e22e">String</span>,<span style="color:#a6e22e">String</span>)]())((<span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">record</span>) =&gt; {
      <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">moviesDecadeGenre</span> = <span style="color:#a6e22e">record</span>.<span style="color:#a6e22e">_2</span>.<span style="color:#a6e22e">groupBy</span>(<span style="color:#a6e22e">_</span>.<span style="color:#a6e22e">_2</span>).<span style="color:#a6e22e">foldLeft</span>(<span style="color:#a6e22e">List</span>[(<span style="color:#a6e22e">Int</span>,<span style="color:#a6e22e">String</span>,<span style="color:#a6e22e">String</span>)]())((<span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">genre</span>) =&gt; {
        <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">max_title</span> = <span style="color:#a6e22e">genre</span>.<span style="color:#a6e22e">_2</span>.<span style="color:#a6e22e">foldLeft</span>((<span style="color:#ae81ff">0.</span><span style="color:#a6e22e">toFloat</span>,<span style="color:#e6db74">&#34;&#34;</span>))((<span style="color:#a6e22e">rating</span>, <span style="color:#a6e22e">movie</span>) =&gt; {
          <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">movie</span>.<span style="color:#a6e22e">_3</span>.<span style="color:#a6e22e">_2</span>.<span style="color:#a6e22e">averageRating</span> &gt; <span style="color:#a6e22e">rating</span>.<span style="color:#a6e22e">_1</span>) {
            (<span style="color:#a6e22e">movie</span>.<span style="color:#a6e22e">_3</span>.<span style="color:#a6e22e">_2</span>.<span style="color:#a6e22e">averageRating</span>, <span style="color:#a6e22e">movie</span>.<span style="color:#a6e22e">_3</span>.<span style="color:#a6e22e">_1</span>.<span style="color:#a6e22e">primaryTitle</span>.<span style="color:#a6e22e">get</span>)
          } <span style="color:#66d9ef">else</span> {
            <span style="color:#a6e22e">rating</span>
          }
        }).<span style="color:#a6e22e">_2</span>
        (<span style="color:#a6e22e">record</span>.<span style="color:#a6e22e">_1</span>, <span style="color:#a6e22e">genre</span>.<span style="color:#a6e22e">_1</span>,<span style="color:#a6e22e">max_title</span>) :: <span style="color:#a6e22e">res</span>
      })
      <span style="color:#a6e22e">moviesDecadeGenre</span> ::: <span style="color:#a6e22e">result</span>
    })
    println(<span style="color:#a6e22e">T3_Result</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">T3_Result</span>.<span style="color:#a6e22e">sortBy</span>(<span style="color:#a6e22e">single</span> =&gt; (<span style="color:#a6e22e">single</span>.<span style="color:#a6e22e">_1</span>, <span style="color:#a6e22e">single</span>.<span style="color:#a6e22e">_2</span>))
  }

  <span style="color:#75715e">// Hint: There could be an input list that you do not really need in your implementation.
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">def</span> <span style="color:#a6e22e">task4</span>(<span style="color:#a6e22e">l1</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">TitleBasics</span>], <span style="color:#a6e22e">l2</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">TitleCrew</span>], <span style="color:#a6e22e">l3</span>: <span style="color:#a6e22e">List</span>[<span style="color:#a6e22e">NameBasics</span>]): <span style="color:#a6e22e">List</span>[(<span style="color:#a6e22e">String</span>, <span style="color:#a6e22e">Int</span>)] = {
    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">crewListFilter</span> = <span style="color:#a6e22e">l3</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">nb</span> =&gt; <span style="color:#a6e22e">nb</span>.<span style="color:#a6e22e">knownForTitles</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#a6e22e">List</span>.<span style="color:#a6e22e">empty</span>).<span style="color:#a6e22e">size</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">2</span>)
    <span style="color:#75715e">//val testCombine = crewListFilter.groupMapReduce(_.nconst)
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//fold together lists where there are more than one name the same in lists
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">moviesFilter</span> = <span style="color:#a6e22e">l1</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">tb</span> =&gt; (<span style="color:#a6e22e">tb</span>.<span style="color:#a6e22e">startYear</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">2010</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">tb</span>.<span style="color:#a6e22e">startYear</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">2021</span>))
    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">listMovieTconst</span> =  <span style="color:#a6e22e">moviesFilter</span>.<span style="color:#66d9ef">map</span>(<span style="color:#a6e22e">movie</span> =&gt; <span style="color:#a6e22e">movie</span>.<span style="color:#a6e22e">tconst</span>)
    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">plsWork</span> = (<span style="color:#a6e22e">crewListFilter</span>.<span style="color:#a6e22e">foldLeft</span>(<span style="color:#a6e22e">Map</span>[<span style="color:#a6e22e">String</span>,<span style="color:#a6e22e">Int</span>]()) {
      (<span style="color:#a6e22e">crewMap</span>, <span style="color:#a6e22e">crewPerson</span>) =&gt;
        <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">numOfMovies</span> = (<span style="color:#a6e22e">crewPerson</span>.<span style="color:#a6e22e">knownForTitles</span>.<span style="color:#a6e22e">getOrElse</span>(<span style="color:#a6e22e">List</span>.<span style="color:#a6e22e">empty</span>).<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">movieTc</span> =&gt; <span style="color:#a6e22e">listMovieTconst</span>.<span style="color:#a6e22e">contains</span>(<span style="color:#a6e22e">movieTc</span>))).<span style="color:#a6e22e">length</span>
        <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">combine</span> = (<span style="color:#a6e22e">crewPerson</span>.<span style="color:#a6e22e">primaryName</span>.<span style="color:#a6e22e">get</span>,<span style="color:#a6e22e">numOfMovies</span>)
        <span style="color:#a6e22e">crewMap</span> <span style="color:#f92672">+</span> (<span style="color:#a6e22e">combine</span>)
    }).<span style="color:#a6e22e">toList</span>
    <span style="color:#75715e">//Filtering by if there is more than 2 
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">result_T4</span> = <span style="color:#a6e22e">plsWork</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">x</span> =&gt; <span style="color:#a6e22e">x</span>.<span style="color:#a6e22e">_2</span> <span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">2</span>)
    println(<span style="color:#a6e22e">result_T4</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result_T4</span>   
  }

  <span style="color:#a6e22e">def</span> <span style="color:#a6e22e">main</span>(<span style="color:#a6e22e">args</span>: <span style="color:#a6e22e">Array</span>[<span style="color:#a6e22e">String</span>]) {
    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">durations</span> = <span style="color:#a6e22e">timed</span>(<span style="color:#e6db74">&#34;Task 1&#34;</span>, <span style="color:#a6e22e">task1</span>(<span style="color:#a6e22e">titleBasicsList</span>))
    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">titles</span> = <span style="color:#a6e22e">timed</span>(<span style="color:#e6db74">&#34;Task 2&#34;</span>, <span style="color:#a6e22e">task2</span>(<span style="color:#a6e22e">titleBasicsList</span>, <span style="color:#a6e22e">titleRatingsList</span>))
    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">topRated</span> = <span style="color:#a6e22e">timed</span>(<span style="color:#e6db74">&#34;Task 3&#34;</span>, <span style="color:#a6e22e">task3</span>(<span style="color:#a6e22e">titleBasicsList</span>, <span style="color:#a6e22e">titleRatingsList</span>))
    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">crews</span> = <span style="color:#a6e22e">timed</span>(<span style="color:#e6db74">&#34;Task 4&#34;</span>, <span style="color:#a6e22e">task4</span>(<span style="color:#a6e22e">titleBasicsList</span>, <span style="color:#a6e22e">titleCrewList</span>, <span style="color:#a6e22e">nameBasicsList</span>))
    println(<span style="color:#a6e22e">durations</span>)
    println(<span style="color:#a6e22e">titles</span>)
    println(<span style="color:#a6e22e">topRated</span>)
    println(<span style="color:#a6e22e">crews</span>)
    println(<span style="color:#a6e22e">timing</span>)
  }

  <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">timing</span> = <span style="color:#a6e22e">new</span> <span style="color:#a6e22e">StringBuffer</span>
  <span style="color:#a6e22e">def</span> <span style="color:#a6e22e">timed</span>[<span style="color:#a6e22e">T</span>](<span style="color:#a6e22e">label</span>: <span style="color:#a6e22e">String</span>, <span style="color:#a6e22e">code</span>: =&gt; <span style="color:#a6e22e">T</span>): <span style="color:#a6e22e">T</span> = {
    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">start</span> = <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">currentTimeMillis</span>()
    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">result</span> = <span style="color:#a6e22e">code</span>
    <span style="color:#a6e22e">val</span> <span style="color:#a6e22e">stop</span> = <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">currentTimeMillis</span>()
    <span style="color:#a6e22e">timing</span>.append(<span style="color:#a6e22e">s</span><span style="color:#e6db74">&#34;Processing $label took ${stop - start} ms.\n&#34;</span>)
    <span style="color:#a6e22e">result</span>
  }
}</code></pre></div>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
            
              <span class="button next">
                <a href="https://rjoc.github.io/posts/myfirstpost/">
                  <span class="button__text">Comp project</span>
                  <span class="button__icon">â†’</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >Ryan O&#39;Connor</span
    >
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span
          >Â© 2021 Powered by
          <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span
        >
        <span
          >Theme created by
          <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span
        >
      </div>
    
  </div>
</footer>

<script src="https://rjoc.github.io/assets/main.js"></script>
<script src="https://rjoc.github.io/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
